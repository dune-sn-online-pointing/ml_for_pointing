{
  "model_type": "three_plane_cnn",
  "version": "v6_focal_10k",
  "description": "3-plane ED regression with focal angular loss (gamma=2.0), 10k matched samples",
  
  "data": {
    "data_directories": [
      "/eos/user/e/evilla/dune/sn-tps/production_es/cluster_images_nov10/"
    ],
    "require_three_plane_match": true,
    "max_samples": 10000,
    "train_split": 0.8,
    "shuffle": true
  },
  
  "model": {
    "input_shape": [128, 16, 1],
    "output_dim": 3,
    "normalize_output": true
  },
  
  "training": {
    "loss": "focal_angular_loss",
    "loss_params": {
      "gamma": 2.0
    },
    "optimizer": "adam",
    "epochs": 100,
    "batch_size": 32,
    "early_stopping_patience": 15,
    "reduce_lr_patience": 5,
    "reduce_lr_factor": 0.5,
    "min_lr": 1e-6
  },
  
  "hyperopt": {
    "enabled": true,
    "max_trials": 5,
    "search_space": {
      "num_conv_layers_base": [2, 3, 4],
      "base_filters": [16, 32, 64],
      "kernel_size": [3, 5],
      "num_dense_layers": [1, 2],
      "dense_units": [128, 256, 512],
      "dropout_rate": [0.2, 0.3, 0.4],
      "learning_rate": [1e-4, 3e-4, 1e-3]
    }
  },
  
  "output": {
    "base_dir": "/eos/user/e/evilla/dune/sn-tps/neural_networks/electron_direction/",
    "save_best_only": true,
    "save_checkpoints": true
  }
}
