{
  "model": {
    "name": "three_plane_v23_200k_mixed_hyperopt",
    "architecture": "three_plane_cnn",
    "input_shape": [128, 32, 1],
    "output_dim": 3,
    "n_conv_layers": 4,
    "n_filters": 64,
    "kernel_size": 3,
    "n_dense_layers": 2,
    "n_dense_units": 256,
    "use_batch_norm": true
  },
  "data": {
    "data_directories": [
      "/eos/home-e/evilla/dune/sn-tps/prod_es/es_prod_cluster_images_tick3_ch2_min2_tot3_e2p0/",
      "/eos/home-e/evilla/dune/sn-tps/prod_cc/cc_prod_cluster_images_tick3_ch2_min2_tot3_e2p0/"
    ],
    "max_samples": 200000,
    "use_matched": true,
    "train_split": 0.7,
    "val_split": 0.15,
    "test_split": 0.15
  },
  "training": {
    "loss": "angular_loss",
    "optimizer": "adam",
    "learning_rate": 0.001,
    "batch_size": 32,
    "epochs": 100,
    "early_stopping_patience": 30,
    "reduce_lr_patience": 10,
    "reduce_lr_factor": 0.5,
    "reduce_lr_min_lr": 1e-6,
    "clipnorm": 1.0,
    "save_predictions": true
  },
  "hyperopt": {
    "enabled": true,
    "n_trials": 20,
    "max_epochs_per_trial": 50,
    "search_space": {
      "n_conv_layers": [3, 4, 5],
      "n_filters": [32, 64, 128],
      "n_dense_layers": [1, 2, 3],
      "n_dense_units": [128, 256, 512],
      "dropout_rate": [0.2, 0.3, 0.4, 0.5],
      "learning_rate": [0.0001, 0.001, 0.01]
    }
  },
  "output": {
    "base_dir": "/eos/user/e/evilla/dune/sn-tps/neural_networks/electron_direction/"
  }
}
