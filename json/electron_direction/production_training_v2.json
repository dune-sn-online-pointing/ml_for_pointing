{
  "model_name": "hyperopt_simple_cnn",
  "output_folder": "/eos/user/e/evilla/dune/sn-tps/neural_networks",
  "data_directories": [
    "/eos/user/e/evilla/dune/sn-tps/production_es/images_es_prod_main_tick3_ch2_min2_tot3_e2p0"
  ],
  "plane": "X",
  "filter_es_only": true,
  "filter_main_track_only": true,
  "dataset_parameters": {
    "train_fraction": 0.7,
    "val_fraction": 0.15,
    "test_fraction": 0.15,
    "shuffle_data": true,
    "balance_data": false,
    "max_samples": null,
    "random_seed": 42,
    "batch_pattern": "*_planeX.npz"
  },
  "model_parameters": {
    "input_shape": [128, 16, 1],
    "output_dim": 3,
    "hp_max_evals": 20,
    "space_options": {
      "n_conv_layers": [2, 3, 4],
      "n_dense_layers": [2, 3, 4],
      "n_filters": [32, 64, 128, 256],
      "kernel_size": [3, 5],
      "n_dense_units": [64, 128, 256, 512],
      "learning_rate": [0.0001, 0.005],
      "decay_rate": [0.90, 0.95, 0.98, 0.999],
      "batch_size": [64, 128, 256]
    },
    "loss_function": "mse",
    "epochs": 100,
    "batch_size": 128,
    "early_stopping": {
      "monitor": "val_loss",
      "patience": 15,
      "restore_best_weights": true
    }
  },
  "save_outputs": {
    "save_model": true,
    "save_history": true,
    "save_predictions": true,
    "save_metrics": true
  },
  "training_notes": {
    "date": "2025-11-03",
    "version": "prod_main_v2_electron_direction",
    "changes_from_previous": [
      "Updated to new file structure: one NPZ per input file per plane",
      "batch_pattern changed to *_planeX.npz",
      "Using ES-only data with main track filter",
      "Expanded hyperparameter search to 20 evaluations",
      "Added batch_size to hyperparameter search"
    ]
  }
}
