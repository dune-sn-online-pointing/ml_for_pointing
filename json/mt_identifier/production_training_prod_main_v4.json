{
  "model_name": "hyperopt_simple_cnn",
  "output_folder": "/eos/user/e/evilla/dune/sn-tps/neural_networks",
  "data_directories": [
    "/eos/user/e/evilla/dune/sn-tps/production_es/images_es_prod_main_tick3_ch2_min2_tot3_e2p0",
    "/eos/user/e/evilla/dune/sn-tps/production_cc/images_cc_prod_main_tick3_ch2_min2_tot3_e2p0"
  ],
  "plane": "X",
  "dataset_parameters": {
    "train_fraction": 0.7,
    "val_fraction": 0.15,
    "test_fraction": 0.15,
    "shuffle_data": true,
    "balance_data": true,
    "balance_method": "undersample",
    "max_samples": null,
    "random_seed": 42,
    "batch_pattern": "*_planeX.npz"
  },
  "model_parameters": {
    "input_shape": [
      128,
      16,
      1
    ],
    "hp_max_evals": 25,
    "space_options": {
      "n_conv_layers": [
        2,
        3,
        4
      ],
      "n_dense_layers": [
        2,
        3
      ],
      "n_filters": [
        32,
        64,
        128,
        256
      ],
      "kernel_size": [
        3,
        5
      ],
      "n_dense_units": [
        64,
        128,
        256
      ],
      "dropout_rate": [
        0.1,
        0.2,
        0.3,
        0.4
      ],
      "learning_rate": [
        0.0001,
        0.005
      ],
      "decay_rate": [
        0.95,
        0.98
      ],
      "batch_size": [
        64,
        128,
        256
      ]
    },
    "epochs": 80,
    "batch_size": 128,
    "early_stopping": {
      "monitor": "val_loss",
      "patience": 10,
      "restore_best_weights": true
    }
  },
  "save_outputs": {
    "save_model": true,
    "save_history": true,
    "save_predictions": true,
    "save_confusion_matrix": true,
    "save_roc_curve": true,
    "save_metrics": true
  },
  "training_notes": {
    "date": "2025-11-04",
    "version": "v4_dropout_regularization",
    "changes_from_previous": [
      "Added dropout_rate to search space: [0.1, 0.2, 0.3, 0.4]",
      "Increased hp_max_evals from 20 to 25 trials",
      "Testing dropout for better generalization",
      "Same matched_clusters dataset from pipeline v2",
      "Set balance_data=true for balanced training"
    ],
    "previous_results": {
      "v1_baseline": {
        "job_id": "17828044",
        "val_accuracy": 0.91887,
        "test_f1": 0.917,
        "best_trial": "2/10",
        "config": "simple architecture without dropout"
      },
      "v2_expanded_search": {
        "val_accuracy": "~0.933",
        "trials": "20",
        "config": "deeper architectures, wider search"
      }
    },
    "rationale": "Previous trainings achieved good results but may benefit from regularization via dropout to improve generalization and potentially reach >93% F1 score. Dropout was identified in TRAINING_NOTES.md as next improvement to try. Using balanced dataset (undersampling) to ensure equal representation of main track vs non-main track samples."
  },
  "metadata": {
    "version": "v4_dropout_regularization",
    "date": "2025-11-04",
    "improvements": [
      "Added dropout_rate: [0.1, 0.2, 0.3, 0.4]",
      "Increased trials: 20 \u2192 25",
      "Full matched_clusters dataset with 2.0 MeV threshold"
    ],
    "baseline_comparison": {
      "v1": {
        "job_id": "17828044",
        "val_accuracy": 0.91887,
        "test_f1": 0.917
      },
      "v2": {
        "val_accuracy": 0.933,
        "trials": 20
      }
    }
  }
}