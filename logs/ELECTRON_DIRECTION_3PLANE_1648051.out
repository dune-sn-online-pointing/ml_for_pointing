======================================================================
HTCondor Job: Electron Direction (Three Planes) Training
======================================================================
Job started at: Tue Nov  4 03:34:50 PM CET 2025
Running on host: b9pgpun058.cern.ch
Working directory: /pool/condor/dir_3064017
======================================================================
Setting up LCG_106_cuda environment...

Environment setup complete
Python version: Python 3.11.9
Python location: /cvmfs/sft.cern.ch/lcg/views/LCG_106_cuda/x86_64-el9-gcc11-opt/bin/python

Checking GPU availability...
Tue Nov  4 15:34:56 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100L-2-24C             Off |   00000000:06:00.0 Off |                   On |
| N/A   N/A    P0            N/A  /  N/A  |       1MiB /  24576MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    0   0   0  |               1MiB / 21547MiB    | 32      0 |  2   0    2    0    2 |
|                  |                 0MiB /  4096MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

TensorFlow GPU check:
TensorFlow version: 2.16.1
GPUs available: 1

======================================================================
Starting training script...
======================================================================
Executing: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/scripts/train_electron_direction_3plane.sh --condor --json /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/electron_direction_3plane/production_training.json
======================================================================
ELECTRON DIRECTION TRAINING (THREE PLANES)
======================================================================
Project directory: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing
JSON config: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/electron_direction_3plane/production_training.json
Run mode: condor
======================================================================
âœ“ Sourced LCG environment: LCG_106_cuda/x86_64-el9-gcc11-opt
âœ“ Added local packages to PYTHONPATH
[0;34m[INFO][0m ML for Pointing Environment
[0;34m[INFO][0m Repository: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing
[0;34m[INFO][0m Python modules: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/python
[0;34m[INFO][0m Data directory: /eos/home-e/evilla/dune/sn-tps/images_test
[0;34m[INFO][0m Output directory: /eos/user/e/evilla/dune/sn-tps/neural_networks
[0;34m[INFO][0m Python version: 3.11.9
[0;32m[SUCCESS][0m TensorFlow 2.16.1 is available

Starting training...
Command: python3 electron_direction_3plane/ed3p_training.py --input_json /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/electron_direction_3plane/production_training.json


======================================================================
ELECTRON DIRECTION TRAINING (THREE PLANES)
======================================================================

âœ“ GPU is available: 1 device(s)
  GPU 0: /physical_device:GPU:0

Loading configuration from: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/electron_direction_3plane/production_training.json
Configuration loaded successfully

Output directory: /eos/user/e/evilla/dune/sn-tps/neural_networks/electron_direction_3plane/d3_views_hp_simple_cnn/20251104_153606
Configuration saved to: /eos/user/e/evilla/dune/sn-tps/neural_networks/electron_direction_3plane/d3_views_hp_simple_cnn/20251104_153606/config.json
Arguments saved to: /eos/user/e/evilla/dune/sn-tps/neural_networks/electron_direction_3plane/d3_views_hp_simple_cnn/20251104_153606/args.json
Selected model: d3_views_hp_simple_cnn

======================================================================
STEP 1: DATA PREPARATION (THREE PLANES)
======================================================================

============================================================
LOADING DATA FROM NPZ FILES (3-PLANE REGRESSION)
============================================================
Data directory: /eos/home-e/evilla/dune/sn-tps/images_test
Batch pattern: *_matched_plane{plane}.npz
Max samples: All

--- Loading plane U ---


âœ— Error during training: No batch files found. Directory: /eos/home-e/evilla/dune/sn-tps/images_test. Patterns tried: ['*_matched_planeU.npz', '*_planeU.npz', '*planeU.npz']

======================================================================
Job finished at: Tue Nov  4 03:36:08 PM CET 2025
Exit code: 1
======================================================================
