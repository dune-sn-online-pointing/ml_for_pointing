=========================================
HTCondor GPU Training Job
=========================================
Job started at: Sun Nov  2 12:22:40 AM CET 2025
Running on host: b9pgpun039.cern.ch
Plane: X
Max samples: json/mt_identifier/production_training_prod_main.json
JSON config: json/mt_identifier/production_training_prod_main.json
=========================================
Setting up LCG environment: LCG_106_cuda/x86_64-el9-gcc11-opt
Using LCG Python: /cvmfs/sft.cern.ch/lcg/views/LCG_106_cuda/x86_64-el9-gcc11-opt/bin/python3
Python 3.11.9


GPU Information:
Sun Nov  2 00:22:44 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100L-2-24C             On  |   00000000:06:00.0 Off |                   On |
| N/A   N/A    P0            N/A  /  N/A  |       1MiB /  24576MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    0   0   0  |               1MiB / 21547MiB    | 32      0 |  2   0    2    0    2 |
|                  |                 0MiB /  4096MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+


Python version: Python 3.11.9
Python path: /cvmfs/sft.cern.ch/lcg/views/LCG_106_cuda/x86_64-el9-gcc11-opt/bin/python3
Checking TensorFlow...
2025-11-02 00:22:49.532215: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-02 00:22:53.032748: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-02 00:23:17.807774: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
TensorFlow version: 2.16.1
2025-11-02 00:23:49.004499: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-11-02 00:23:50.908605: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-11-02 00:23:50.921224: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
GPUs detected: 1
  - /physical_device:GPU:0

Running: ./scripts/train_mt_identifier.sh -j json/mt_identifier/production_training_prod_main.json --plane X --max-samples json/mt_identifier/production_training_prod_main.json
=========================================
âœ“ Sourced LCG environment: LCG_106_cuda/x86_64-el9-gcc11-opt
âœ“ Added local packages to PYTHONPATH
[0;34m[INFO][0m ML for Pointing Environment
[0;34m[INFO][0m Repository: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing
[0;34m[INFO][0m Python modules: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/python
[0;34m[INFO][0m Data directory: /eos/home-e/evilla/dune/sn-tps/images_test
[0;34m[INFO][0m Output directory: /eos/user/e/evilla/dune/sn-tps/neural_networks
[0;34m[INFO][0m Python version: 3.11.9
[0;32m[SUCCESS][0m TensorFlow 2.16.1 is available
[0;34m[INFO][0m Starting Main Track Identifier Training
[0;34m[INFO][0m Configuration: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/mt_identifier/production_training_prod_main.json
[0;34m[INFO][0m Plane: X
[0;34m[INFO][0m Max samples: json/mt_identifier/production_training_prod_main.json
[0;34m[INFO][0m Running training script...
[0;34m[INFO][0m Command: python mt_training.py --input_json /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/json/mt_identifier/production_training_prod_main.json --plane X --max_samples json/mt_identifier/production_training_prod_main.json


======================================================================
MAIN TRACK IDENTIFIER TRAINING
======================================================================
