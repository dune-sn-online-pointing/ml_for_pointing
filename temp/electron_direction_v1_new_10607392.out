=========================================
HTCondor Electron Direction Training
Job started: Wed Nov  5 04:21:08 PM CET 2025 | Host: b9p13p3408.cern.ch
Config: json/electron_direction/production_training_new.json | Plane: X
=========================================
No GPU
Running: ./scripts/train_electron_direction.sh -j json/electron_direction/production_training_new.json --plane X
âœ“ Sourced LCG environment: LCG_106_cuda/x86_64-el9-gcc11-opt
âœ“ Added local packages to PYTHONPATH
[0;34m[INFO][0m ML for Pointing Environment
[0;34m[INFO][0m Repository: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing
[0;34m[INFO][0m Python modules: /afs/cern.ch/work/e/evilla/private/dune/ml_for_pointing/python
[0;34m[INFO][0m Data directory: /eos/home-e/evilla/dune/sn-tps/images_test
[0;34m[INFO][0m Output directory: /eos/user/e/evilla/dune/sn-tps/neural_networks
[0;34m[INFO][0m Python version: 3.11.9
[0;32m[SUCCESS][0m TensorFlow 2.16.1 is available
Running: python3 electron_direction/ed_training.py --input_json json/electron_direction/production_training_new.json --plane X

======================================================================
MAIN TRACK IDENTIFIER TRAINING
======================================================================

âš  GPU is NOT available - training will use CPU

Loading configuration from: json/electron_direction/production_training_new.json
Configuration loaded successfully

Output directory: outputs/electron_direction/production_v1_new/mt_identifier/simple_cnn/plane_X/20251105_162216
Configuration saved to: outputs/electron_direction/production_v1_new/mt_identifier/simple_cnn/plane_X/20251105_162216/config.json
Arguments saved to: outputs/electron_direction/production_v1_new/mt_identifier/simple_cnn/plane_X/20251105_162216/args.json
Selected model: simple_cnn

======================================================================
STEP 1: DATA PREPARATION
======================================================================

============================================================
LOADING DATA FROM NPZ FILES (REGRESSION)
============================================================
Data directory: /eos/home-e/evilla/dune/sn-tps/images_test
Plane: X
Max samples: All
Found 1 batch file(s) for plane X (pattern: clusters_planeX_batch*.npz)
Loading clusters_planeX_batch0000.npz... loaded 331 samples (total: 331)

Total loaded: 331 samples from plane X
Image shape: (331, 128, 16)
Metadata shape: (331, 11)
Dataset shape: (331, 128, 16)
Direction labels shape: (331, 3)
Direction labels range: [0.000, 0.000]

Data split:
  Train: 264 samples, labels shape: (264, 3)
  Val: 33 samples, labels shape: (33, 3)
  Test: 34 samples, labels shape: (34, 3)

======================================================================
STEP 2: MODEL TRAINING
======================================================================


âœ— Error during training: 'loss_function'
